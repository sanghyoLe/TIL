# 브라우저의 렌더링 원리

### 렌더링이란?
- 서버로부터 HTML 파일 받아 브라우저에 뿌려주는 과정
- HTML, CSS, JS로 작성된 문서를 파싱하여 브라우저에 시각적으로 출력하는 것

### 파싱 (구문분석)
- 텍스트 문서의 문자열을 토큰으로 분해(어휘 분석)하고, 
토큰에 문법적 의미와 구조를 반영하여 Parse Tree를 생성하는 일련의 과정
- 토큰: 문법적으로 의미가 있는 최소 단위

서버로부터 받아온 리소스들은 텍스트에 불과하기 때문에 파싱을 통해<br>
브라우저가 이해할 수 있는 자료구조 형태로 만들어야 한다.


소스코드 자체는 텍스트 문서에 불과하다.<br>
파싱이라는 과정을 거쳐서 문법적인 의미를 부여해야 컴퓨터가 언어를 해석할 수 있다.
- HTML -> 파싱 -> DOM Tree,
- CSS -> 파싱 -> CSSOM,
- JS -> 파싱 -> AST(Abstract Syntax Tree),

브라우저가 화면에 나타내는 요소를 렌더링할 때, 웹킷, 게코등과 같은 렌더링엔진을 사용한다. <br>
렌더링 엔진이 HTML, CSS, JavaScript로 렌더링할 때 CRP라는 프로세스를 사용하며 6단계로 이루어져있다.

### 렌더링 과정
1. HTML 파싱 후, DOM Tree 구축
2. CSS 파싱 후, CSSOM Tree 구축 
3. JavaScript 해석, 컴파일, 파싱 및 실행 
4. DOM과 CSSOM을 조합하여 렌더트리를 구축 
    - display: none 속성과 같이 화면에서 보이지도 않고<br>공간을 차지하지 않는 것들은 렌더트리로 구축되지 않는다.
5. 뷰포트 기반으로 렌더트리의 각 노드가 가지는 정확한 위치와 크기를 계산한다. (Layout 단계)
6. 계산한 위치/크기를 기반으로 화면에 그린다. (Paint 단계)
----------------------------------------------------------------

## 용어


### CRP(Critical Rendering Path, 중요 렌더링 경로)

- HTML, CSS, JS를 화면에 픽셀로 변화하는 일련의 단계<br>
- DOM, CSSOM, 렌더트리, 레이아웃을 포함한다.

### DOM(Document Object Model)

- 웹 페이지를 이루는 태그들을 자바스크립트가 이용할 수 있게끔 브라우저가 트리구조로 만든 객체 모델을 의미
- 문서 객체란 html, head, body와 같은 태그들을 javascript가 이용할 수 있는 객체를 의미<br>
- HTML과 스크립팅 언어(JavaScript)를 서로 이어주는 역할을 함

### CSSOM (CSS Object Model)
- CSS 내용을 파싱하 자를 구조화 한것을 CSSOM 이라 한다.
- DOM 처럼 CSS의 내용을 해석하고 노드를 만들어 트리 구조를 만든 것

### 렌더트리 (Render Tree)
- 렌더 트리는 CSSOM 과 DOM 트리의 결합으로 만들어진다.
- 렌더 트리는 웹 페이지에 나타낼 각 요소들의 위치(Layout)를 계산
- 픽셀을 화면에 렌더링 하는 페인트(Paint) 즉, 화면에 요소들을 표현하는 프로세스를 위해 존재

### Layout(Reflow)
- 뷰포트 내에서 노드의 정확한 위치와 크기를 계산한다.
- 뷰포트란?
    - 현재 보고 있는 화면의 영역
    - 웹 브라우저 용어로 UI, 메뉴바 등을 제외하고는 일반적으로 브라우저 창과 동일
- 이를 Layout 단계라고 하며, 경우에 따라 Reflow라고 한다.

Paint 
- 노드와 해당 노드의 계산된 스타일 및 기하학적 형태에 대해 파악했으므로, 렌더링 트리의 각 노드를 화면의 실제 픽셀로 변환하는 마지막 단계에 이 정보를 전달
- 페인팅 또는 래스터화라고 한다.

